<div class="mt-2">
  <app-caliber-dropdown
    [initDropdown]="0"
    [disable]="disableDropdown()"
    (selectedCaliber)="loadAmmunitionWeights($event.id)"></app-caliber-dropdown>

  <div class="mt-5">
    <h2 class="text-blue-500 text-center">
      {{result()}} {{result() <2 ? 'resultat' : 'resultats'}}
    </h2>
    @if (result() > 0 && !visible){
    <p-table [value]="weights" [tableStyle]="{ 'min-width': '50rem' }">
      <ng-template pTemplate="header">
        <tr>
          <th>Id</th>
          <th>Grains</th>
          <th>Grammes</th>
          <th>Ajouter le</th>
          <th>Status</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-weight>
        <tr>
          <td>{{ weight.id }}</td>
          <td>{{ weight.grains }} grains</td>
          <td>{{ weight.grams }} grammes</td>
          <td>{{ weight.createdAt | date:'dd MMM yyyy' }}</td>
          <td>
            <div class="flex align-items-center">
              {{ weight.active ? 'Actif':'Desactiv√©' }}
              <p-button
                icon="pi pi-ban"
                severity="danger"
                [text]="true"
                (onClick)="confirm($event,weight.id)"></p-button>
            </div>
          </td>
        </tr>
      </ng-template>
    </p-table>
    }
    <div class="mt-2 text-center">
      <p-button
        label="{{ visible ? 'Annuler' : 'Ajouter' }}"
        icon="pi {{visible ? 'pi-times' : 'pi-plus'}}"
        (onClick)="add()"></p-button>
    </div>
    @defer (when visible){ @if (visible){
    <app-ammunition-weight-add
      (newWeight)="newWeight($event)"></app-ammunition-weight-add>
    } }
  </div>
</div>
